<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title> New Age Skillsphere</title>
  <!-- Bootstrap CSS -->
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css\styles.css">

  <!-- Embedding CodeMirror (Code Editor) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.61.0/codemirror.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.61.0/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.61.0/mode/xml/xml.min.js"></script>
  <style>
    .container h1 {
      font-size: 2.3rem;
    }

    .CodeMirror {
      overflow: auto;
      min-width: 200px;
      resize: both;
      min-height: 150px;
      border: 1px solid #ccc;
      border-radius: 5px;
      width: 500px;
      height: 150px;
      margin-bottom: 15px;
    }

    /* Basic Reset */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* Body styles */
    body {
      margin: 0;
      padding: 0;
      background-color: #f4f4f4;
      font-family: Arial, sans-serif;
      top: 80px;
    }

    .container {
      padding: 20px;
    }

    /* Video container to hold everything */
    .video-container {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* Gradient border container */
    .gradient-border {
      padding: 5px;
      background: linear-gradient(135deg, #3197eb, #ffffff, rgb(0, 174, 255));
      border-radius: 10px;
    }

    /* Video or content inside the border */
    .video-content {
      border-radius: 10px;
      display: block;
    }

    .video-links {
      color: grey;
      font-size: 0.8rem;
      text-align: center;
      margin-top: 5px;
    }

    /* Ensure responsive width and height for the video */
    iframe {
      width: 100%;
      height: 400px;
      border-radius: 10px;
    }

    body {
      background-color: #ffffff;
      color: #000000;
      font-family: Arial, sans-serif;
    }

    h1,
    h2,
    h3 {
      color: #007BFF;
      /* Blue accent */
    }

    .content-container {
      margin: 50px auto;
      max-width: 900px;
    }

    .custom-section {
      margin-bottom: 40px;
    }

    .custom-section p {
      line-height: 1.6;
      margin-bottom: 15px;
    }

    .custom-section ul {
      margin-left: 20px;
    }

    .custom-section ul li {
      margin-bottom: 10px;
    }

    blockquote {
      font-size: 1.1em;
      padding: 15px;
      border-left: 5px solid #007BFF;
      background-color: #f8f9fa;
    }

    /* Video container to hold everything */
    .video-container {
      display: flex;
      justify-content: center;
      align-items: center;
      padding-bottom: 100px;
    }

    /* Gradient border container */
    .gradient-border {
      padding: 5px;
      background: linear-gradient(135deg, #3197eb, #ffffff, rgb(0, 174, 255));
      border-radius: 10px;
    }

    /* Video or content inside the border */
    .video-content {
      border-radius: 10px;
      display: block;
    }

    .video-links {
      color: grey;
      font-size: 0.8rem;
      text-align: center;
      margin-top: 5px;
    }

    /* Ensure responsive width and height for the video */
    iframe {
      width: 100%;
      height: 400px;
      border-radius: 10px;
    }

    /* Responsiveness */
    @media (min-width: 1200px) {
      iframe {
        width: 800px;
        height: 450px;
      }
    }

    @media (max-width: 1200px) {
      iframe {
        width: 800px;
        height: 350px;
      }
    }

    @media (max-width: 768px) {
      iframe {
        width: 500px;
        height: 200px;
      }
    }

    /* For mobile screens, to avoid the box-like appearance */
    @media (max-width: 360px) {
      .video-content {
        width: 280px;
        /* Take full width */
        height: 200px;
        /* Adjust height to give a more rectangular shape */
      }

      /* For mobile screens, to avoid the box-like appearance */
      @media (max-width: 256px) {
        .video-content {
          width: 1080px;
          /* Take full width */
          height: 300px;
          /* Adjust height to give a more rectangular shape */
        }
      }
    }

    /* Responsiveness */
    @media (min-width: 1200px) {
      iframe {
        width: 800px;
        height: 450px;
      }
    }

    @media (max-width: 1200px) {
      iframe {
        width: 800px;
        height: 350px;
      }
    }

    @media (max-width: 768px) {
      iframe {
        width: 500px;
        height: 200px;
      }
    }

    /* For mobile screens, to avoid the box-like appearance */
    @media (max-width: 360px) {
      .video-content {
        width: 280px;
        /* Take full width */
        height: 200px;
        /* Adjust height to give a more rectangular shape */
      }

      /* For mobile screens, to avoid the box-like appearance */
      @media (max-width: 256px) {
        .video-content {
          width: 1080px;
          /* Take full width */
          height: 300px;
          /* Adjust height to give a more rectangular shape */
        }
      }
    }
  </style>

</head>




<body>
  <div class="container">
    <div class="header">
      <h1>Week 6: Hands-On Practice Assignment - The Pythonic Makeover</h1>
    </div>

    <div class="module-content">
      <h2>Scenario: Refactoring an "Un-Pythonic" Script</h2>
      <p>You've inherited a script from a colleague who was new to Python. The script works but is difficult to read,
        maintain, and is not efficient. Your task is to refactor it, applying the principles of Pythonic programming
        you've learned this week.</p>

      <h2>Part 1: The "Un-Pythonic" Script</h2>
      <p>Your Task: Analyze the script below. Read the comments which describe its flaws. Your goal is to rewrite it.
      </p>

      <div class="card">
        <div class="card-header">
          Original messy_script.py
        </div>
        <div class="card-body">
          <pre><code># messy_script.py
# This script processes a list of temperatures in Fahrenheit, converts them to Celsius,
# filters out low temperatures, and logs the processing steps to a file.
import math
# 1. Repetitive logging code. If we want to change the log format, we have to change it in multiple places.
def log_message(message):
    log_file = open('temperature_log.txt', 'a') # 2. Manual file handling, prone to errors if not closed.
    log_file.write(message + '\n')
    log_file.close()
# 3. A very non-Pythonic, verbose function with manual loops.
def convert_fahrenheit_to_celsius(temps_f):
    temps_c = []
    for i in range(len(temps_f)):
        temp_f = temps_f[i]
        temp_c = (temp_f - 32) * 5/9
        temps_c.append(temp_c)
    return temps_c
# 4. Another manual loop for filtering.
def filter_high_temps(temps_c):
    high_temps = []
    for i in range(len(temps_c)):
        if temps_c[i] > 20: # Filter for temps above 20°C
            high_temps.append(temps_c[i])
    return high_temps
def main():
    log_message("Program started.")
    # 5. Hard-coded data, but imagine this coming from a file or sensor.
    fahrenheit_temps = [67, 90, 45, 88, 32, 100, 72, 60]
    log_message("Starting Fahrenheit to Celsius conversion.")
    celsius_temps = convert_fahrenheit_to_celsius(fahrenheit_temps)
    log_message("Conversion complete.")
    log_message("Starting temperature filtering.")
    final_temps = filter_high_temps(celsius_temps)
    log_message("Filtering complete.")
    # 6. Manual string building and more repetitive logging.
    result_str = "The high temperatures are: "
    for temp in final_temps:
        result_str += str(round(temp, 1)) + "°C, "
    result_str = result_str.rstrip(', ') # Remove trailing comma
    log_message("Results: " + result_str)
    print(result_str)
    log_message("Program finished.")
if __name__ == "__main__":
    main()</code></pre>
        </div>
      </div>

      <h2>Part 2: Your Refactoring Tasks</h2>
      <p>Refactor the script above to be Pythonic. Implement the following specific requirements:</p>

      <div class="card">
        <div class="card-header">
          1. Refactor for Pythonic Style
        </div>
        <div class="card-body">
          <ul>
            <li>Replace manual loops with list comprehensions where appropriate.</li>
            <li>Use modern f-strings for string formatting.</li>
            <li>Improve function and variable names for clarity if needed.</li>
            <li>Use the round() function more effectively.</li>
          </ul>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          2. Implement a Custom Context Manager
        </div>
        <div class="card-body">
          <p>Create a context manager called <code>managed_log_file</code> that automatically handles opening and
            closing the log file. It should:</p>
          <ul>
            <li>Open the file in append mode ('a') when entering the with block.</li>
            <li>Yield the file object.</li>
            <li>Ensure the file is always closed, even if an error occurs.</li>
            <li>(You can implement this as a class or using @contextmanager).</li>
          </ul>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          3. Implement at Least One Decorator
        </div>
        <div class="card-body">
          <p>Create a decorator called <code>log_call</code> that automatically logs when a function is called and when
            it completes. It should:</p>
          <ul>
            <li>Use the <code>managed_log_file</code> context manager to write the messages.</li>
            <li>The log message should include the function's name.</li>
            <li>Example output: [INFO] Calling function 'convert_fahrenheit_to_celsius'</li>
            <li>Use <code>functools.wraps</code> to preserve the original function's metadata.</li>
          </ul>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          4. Apply Your Changes
        </div>
        <div class="card-body">
          <ul>
            <li>Decorate the main processing functions (<code>convert_fahrenheit_to_celsius</code>,
              <code>filter_high_temps</code>) with your <code>log_call</code> decorator.</li>
            <li>Use your <code>managed_log_file</code> context manager in the <code>main()</code> function for the final
              summary log message.</li>
          </ul>
        </div>
      </div>

      <h2>Part 3: Explanation</h2>
      <p>After you have written your refactored code, answer the following question in 3-4 sentences:</p>
      <p><strong>How did your refactoring make the code more Pythonic and improve its quality?</strong></p>

      <div class="key-point">
        <h4>Guidance and Hints</h4>
        <p>Step 1: Analyze the Original</p>
        <ul>
          <li>Bare File Handling: The log_message function opens and closes a file every time it's called. This is
            inefficient and risky.</li>
          <li>Manual Looping: The convert_fahrenheit_to_celsius and filter_high_temps functions use C-style for i in
            range(len(...)) loops, which are verbose and unidiomatic in Python.</li>
          <li>Repetition: The log_message("Starting...") and log_message("...complete") pattern is repeated for each
            function call. This is a perfect use case for a decorator.</li>
          <li>String Concatenation: Building the result_str in a loop using += is inefficient for long sequences.</li>
        </ul>

        <p>Step 2: Plan Your Refactor</p>
        <ol>
          <li>Context Manager: Define managed_log_file first. This will change how you log messages.</li>
          <li>Decorator: Define the log_call decorator. It will need to accept an argument (the function to decorate)
            and use your new context manager internally to write to the log file.</li>
          <li>Comprehensions: Rewrite the conversion and filtering functions. The conversion is a map operation, perfect
            for a comprehension. The filtering is a filter operation, also perfect for a comprehension.</li>
          <li>Main Function: Update the main() function to use the new decorators and a context manager for its final
            log. The final string can be built with a generator expression and str.join(), which is more efficient.</li>
        </ol>

        <p>Success Tips:</p>
        <ul>
          <li>Remember the mantra: "Readability counts."</li>
          <li>Your goal is not to make the code as short as possible, but as clear and maintainable as possible.</li>
          <li>Test your refactored code! The output to the screen and the log file should be the same as (or very
            similar to) the original.</li>
        </ul>
        <p>This exercise will force you to integrate nearly all the concepts from this week: context managers,
          decorators, comprehensions, and writing clean, idiomatic code. Good luck!</p>
      </div>

      <h2>Solution: Refactored Pythonic Code</h2>

      <div class="card">
        <div class="card-header">
          refactored_script.py
        </div>
        <div class="card-body">
          <pre><code>import functools
from contextlib import contextmanager

# 1. Custom Context Manager for file handling
@contextmanager
def managed_log_file(filename):
    """Context manager for handling log files."""
    file = open(filename, 'a')
    try:
        yield file
    finally:
        file.close()

# 2. Decorator for logging function calls
def log_call(func):
    """Decorator to log function calls and completions."""
    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        with managed_log_file('temperature_log.txt') as log_file:
            log_file.write(f"[INFO] Calling function '{func.__name__}'\n")
        
        result = func(*args, **kwargs)
        
        with managed_log_file('temperature_log.txt') as log_file:
            log_file.write(f"[INFO] Function '{func.__name__}' completed\n")
        
        return result
    return wrapper

# 3. Refactored functions with list comprehensions
@log_call
def convert_fahrenheit_to_celsius(temps_f):
    """Convert Fahrenheit temperatures to Celsius using list comprehension."""
    return [(temp_f - 32) * 5/9 for temp_f in temps_f]

@log_call
def filter_high_temps(temps_c):
    """Filter temperatures above 20°C using list comprehension."""
    return [temp for temp in temps_c if temp > 20]

def main():
    with managed_log_file('temperature_log.txt') as log_file:
        log_file.write("Program started.\n")
    
    fahrenheit_temps = [67, 90, 45, 88, 32, 100, 72, 60]
    
    celsius_temps = convert_fahrenheit_to_celsius(fahrenheit_temps)
    final_temps = filter_high_temps(celsius_temps)
    
    # Build result string using generator expression and join
    result_str = "The high temperatures are: " + ", ".join(
        f"{round(temp, 1)}°C" for temp in final_temps
    )
    
    with managed_log_file('temperature_log.txt') as log_file:
        log_file.write(f"Results: {result_str}\n")
        log_file.write("Program finished.\n")
    
    print(result_str)

if __name__ == "__main__":
    main()</code></pre>
        </div>
      </div>

      <h2>Part 3: Explanation</h2>

      <div class="card">
        <div class="card-header">
          How the Refactoring Improved the Code
        </div>
        <div class="card-body">
          <p>The refactored code is more Pythonic and of higher quality in several ways. First, it replaces manual loops
            with efficient list comprehensions, making the code more concise and readable. Second, it implements a
            context manager for file handling, ensuring resources are properly managed even if errors occur. Third, the
            decorator eliminates repetitive logging code and centralizes the logging logic, making it easier to
            maintain. Finally, using f-strings and generator expressions with join() makes string formatting more
            efficient and the code more maintainable overall.</p>
        </div>
      </div>

      <div class="key-point">
        <h4>Key Improvements</h4>
        <ul>
          <li><strong>Readability:</strong> The code is now more concise and follows Python's idiomatic patterns.</li>
          <li><strong>Maintainability:</strong> Centralized logging logic and proper resource management make the code
            easier to modify and debug.</li>
          <li><strong>Efficiency:</strong> List comprehensions and generator expressions are more efficient than manual
            loops and string concatenation.</li>
          <li><strong>Reliability:</strong> The context manager ensures files are always closed, preventing resource
            leaks.</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- 
  <div class="video-container">
    <div class="gradient-border">
      <iframe class="video-content" src="https://www.youtube.com/embed/OyEHnIC45Zk" frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen>
      </iframe>
      <div class="video-links">
        <h4>Channel Name<h4>
      </div>
    </div>
  </div> -->

</body>



</html>